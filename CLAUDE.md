# Claude Code Usage Documentation

This document explains how Claude Code is used to develop the Evolution of Todo application following Spec-Driven Development (SDD) principles.

## Current Phase: II - Full-Stack Web Application

**Branch**: `002-fullstack-web-app`
**Specification**: `specs/002-fullstack-web-app/`

## Phase II Overview

Transform Phase I console application into a multi-user web application with:
- User authentication (Better Auth + JWT)
- Persistent storage (Neon PostgreSQL)
- Next.js frontend + FastAPI backend

## Monorepo Structure

```
hackathon-todo/
├── .specify/           # Spec-Kit Plus configuration
├── specs/              # Feature specifications
├── frontend/           # Next.js 16+ App Router
├── backend/            # FastAPI + SQLModel
├── src/                # Phase I console app (legacy)
├── CLAUDE.md           # This file
├── docker-compose.yml  # Local development
└── README.md           # Setup instructions
```

## Technology Stack

| Layer | Technology | Reference |
|-------|------------|-----------|
| Frontend | Next.js 16+, TypeScript, Tailwind | @constitution |
| Backend | FastAPI, SQLModel, Python 3.11+ | @constitution |
| Database | Neon PostgreSQL | @constitution |
| Auth | Better Auth, JWT (HS256) | @constitution |

## Key Standards

### Authentication
- JWT tokens signed with `BETTER_AUTH_SECRET` (HS256)
- Token expiration: 24 hours
- Claims: `sub` (user_id), `email`, `iat`, `exp`

### User Isolation
- All task queries MUST filter by `user_id`
- Return 404 (not 403) for unauthorized access

### REST API Conventions
- All routes under `/api/` prefix
- Response format: `{error: {code, message, details[]}}`
- Status codes: 200, 201, 401, 404, 409, 422

## Environment Variables

| Variable | Layer | Purpose |
|----------|-------|---------|
| `DATABASE_URL` | Backend | PostgreSQL connection |
| `BETTER_AUTH_SECRET` | Both | JWT signing (32+ chars) |
| `NEXT_PUBLIC_API_URL` | Frontend | Backend API URL |

## Layer-Specific Instructions

- **Frontend**: See `frontend/CLAUDE.md`
- **Backend**: See `backend/CLAUDE.md`
- **Specs**: See `specs/002-fullstack-web-app/`

## Constitution Compliance

| Principle | Requirement |
|-----------|-------------|
| I. Spec-Driven | All features from specs |
| II. Traceability | Code references specs |
| III. Security | JWT auth, user isolation |
| IV. Separation | Frontend/backend/database |
| V. Scalability | Monorepo, env config |

---

## Phase I Reference (Legacy)

Phase I implemented a console-based todo application:

### Architecture (Phase I)

| Decision | Choice | Rationale |
|----------|--------|-----------|
| Storage | In-memory Dict | O(1) lookups, simplicity |
| ID Generation | Sequential counter | Never recycled per spec |
| Module Separation | 4-layer | Maintainability principle |
| Error Handling | Custom exceptions | Clear error messages |

### Project Structure (Phase I)

```
src/
├── models/       # Task entity
├── services/     # Business logic
├── cli/          # User interface
├── validators/   # Input validation
└── exceptions/   # Custom errors
```

## Prompt History

All prompts and responses are recorded in:
- `history/prompts/constitution/` - Constitution setup
- `history/prompts/001-todo-console-app/` - Phase I development
- `history/prompts/002-fullstack-web-app/` - Phase II development

## No Manual Edits

Per Constitution SC-005: All code is generated by Claude Code with no manual edits.
